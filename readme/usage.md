## Usage

 __signalk-threshold-notifier__ is configured through the Signal K Node server
plugin configuration interface.
Navigate to _Server_->_Plugin config_ and select the _Threshold notifier_ tab.

![Configuration panel](readme/config.png)

The plugin configuration consists of a list of rules, each of which specifies
a Signal K path which should be monitored, upper and lower limits against
which notifications should be raised and the attributes of such notifications.
On first use the list of monitored paths will be empty.

New rules can be added by clicking the __[+]__ button and any existing,
unwanted, rules can be deleted by clicking their adjacent __[x]__ button.

Each rule includes the following fields.

__Monitored path__  
A required text value which specifies the Signal K Node server path which
should be monitored.
There is no default value.

Enter here the full Signal K path for the value which you would like to
monitor, for example, "tanks.wasteWater.0.currentValue".

__Notification message__  
An optional text message which will be assigned to the message property of
all notifications generated by the rule.
The default value is a simple, automatically generated, message.

Enter here the text of the message you would like to be issued when the
monitored path value crosses one of the defined thresholds.
If the option is left blank then the plugin will insert just the monitored
path text as an identifier when it raises a notification.

Any of the following tokens may be used in the supplied message text and these
will be interpolated with the described value when the notification message is
composed.

_${path}_ will be replaced by the value of the _Monitored path_ option.

_${test}_ will be replaced by one of "above", "below" or "between" dependant
upon the threshold being crossed and the direction of crossing.

_${threshold}_ will be replaced with the value of the threshold triggering the
rule or, in the case of the path value being between thresholds with the
string "_n_ and _m_" where _n_ is the low threshold and _m_ is the high
threshold.

_${value}_ will be replaced with the instantaneous value of the monitored path
that triggered the rule.

_${vessel}_ will be replaced with Signal K's idea of the vessel name.

An example message text might be "${vessel}: ${path} is ${test} ${threshold} (currently ${value})".

__Low threshold__  
An optional numerical value which sets the lower threshold against which the
monitored path value will be compared.
The default value is a blank entry which disables monitoring of the
low-threshold.

If a value is supplied and the path value falls below this limit then a
notification of the type specified by the associated options will be issued.
If the 'two-way' option is set, then a notification will again be issued when
the monitored value returns above this limit.

__Alarm state__  
A required value which will be assigned to the notification _state_ property
which is used to signal the severity of the notification.
Default is to set the alarm state to "alert".

Choose a value appropriate to the notification event.
Remember that notifications in Signal K may be processed by downstream handlers
and the chosen state could have significance elsewhere: an example is the
__signalk-switchbank__ plugin which treats "normal" and non-"normal" alarm
states as binary switch signals.

__Suggested method__  
An optional value which will be assigned to the notification _method_ property
which is used to suggest to downstream notification handlers a preference for
how ai notification may be announced.
Default is to express no preference.

Choose a value which you think appropriate, or none at all.

__Options__  

_==> two-way_ causes a notification to be issued when the monitored path value
returns above the specified threshold.
A notification issued in this way always has its _state_ property set to
"normal".

The cluster of options associated with defining a high threshold have similar
semantics to those described above: the __High threshold__ option itself,
naturally, defines an upper threshold against which the monitored path value
will be tested for a low-to-high transition.
